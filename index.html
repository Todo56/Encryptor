<html lang="en">
<head>
    <title>File Encryptor</title>
    <link crossorigin="anonymous" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
          integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" rel="stylesheet">
    <link crossorigin="anonymous" href="https://stackpath.bootstrapcdn.com/bootswatch/4.5.2/darkly/bootstrap.min.css"
          integrity="sha384-nNK9n28pDUDDgIiIqZ/MiyO3F4/9vsMtReZK39klb/MtkZI3/LtjSjlmyVPS3KdN" rel="stylesheet">
    <link crossorigin="anonymous" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css"
          integrity="sha512-HK5fgLBL+xu6dm/Ii3z4xhlSUyZgTT9tuc/hSrtw6uzJOvgRr2a9jyxxT1ely+B+xFAmJKVSTbpM/CuL7qxO8w=="
          rel="stylesheet"/>
          <script data-ad-client="ca-pub-9649257326142774" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</head>
<body class="">
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <img alt="" class="d-inline-block align-top" height="30" src="https://todo56.dev/assets/images/logo.png" width="30">
    <a class="navbar-brand" href="#">Online Encryptor</a>
    <button aria-controls="navbarColor02" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler"
            data-target="#navbarColor02" data-toggle="collapse" type="button">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarColor02">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item active">
                <a class="nav-link" href="/">Encrypt</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/">Decrypt</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/hash">Hash</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="./faq">FAQ</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/legal">Legal</a>
            </li>
        </ul>
    </div>
</nav>
<div class="container">
    <br>
    <h1 class="text-center">Data Encrypt/Decrypt</h1><br>
    <h5>I advise you to check the <a href="./faq">FAQ</a> questions before using this tool.</h5>
    <div class="row">
        <div class="col-md-6">
            <div class="card">
                <div class="card-body">
                    <h3><b>Encrypt Data</b></h3><br>
                    <div class="form-group">
                        <label for="text">Data to Encrypt</label>
                        <textarea class="form-control" id="text" rows="3"></textarea>
                    </div>
                    <h5>OR</h5><br>
                    <div class="form-group">
                        <label for="toencryptfile">Choose a File to Encrypt</label>
                        <input class="" id="toencryptfile" type="file">
                    </div>
                    <br>
                    <div class="form-group">
                        <label for="encryption-algo">Encryption Algorithm</label>
                        <select class="form-control" id="encryption-algo">
                            <option selected value="aes">AES (Secure)</option>
                            <option value="tripledes">Triple DES (Secure)</option>
                            <option value="rabbit">Rabbit (Secure)</option>
                            <option value="rc4drop">RC4Drop (Secure)</option>
                            <option value="rc4">RC4 (Unsecure)</option>
                            <option value="des">DES (Unsecure)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="password">Encryption Password</label>
                        <input class="form-control" id="password" type="text">
                    </div>
                    <button class="btn btn-primary" onclick="encryptData()">Encrypt</button>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card">
                <div class="card-body">
                    <h3><b>Decrypt Data</b></h3><br>
                    <div class="form-group">
                        <label for="text">Data to Decrypt</label>
                        <textarea class="form-control" id="dtext" rows="3"></textarea>
                    </div>
                    <h5>OR</h5><br>
                    <div class="form-group">
                        <label for="todencryptfile">Choose a File to Decrypt</label>
                        <input class="" id="todencryptfile" type="file">
                    </div>
                    <br>
                    <div class="form-group">
                        <label for="encryption-algo">Decryption Algorithm</label>
                        <select class="form-control" id="dencryption-algo">
                            <option selected value="aes">AES (Secure)</option>
                            <option value="tripledes">Triple DES (Secure)</option>
                            <option value="rabbit">Rabbit (Secure)</option>
                            <option value="rc4drop">RC4Drop (Secure)</option>
                            <option value="rc4">RC4 (Unsecure)</option>
                            <option value="des">DES (Unsecure)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="password">Decryption Password</label>
                        <input class="form-control" id="dpassword" type="text">
                    </div>
                    <button class="btn btn-primary" onclick="decryptData()">Decrypt</button>
                </div>
            </div>
        </div>
    </div>
    <br><br>
    <h2>Output:</h2>
    <div class="row">
        <div class="col-md-12">
            <div class="card">
                <div class="card-body">
                    <input class="form-control" id="data" readonly value="">
                </div>
            </div>
            <br>
            <button class="btn btn-success" data-clipboard-target="#data" id="copy"><i class="fa fa-clipboard"></i> Copy
                to Clipboard
            </button>
        </div>
    </div>
    <br><br>
</div>
<footer class="bd-footer p-3 p-md-5 mt-5 bg-dark text-center text-sm-start">
    <div class="container">
        <img alt="" class="mb-2" height="24" src="https://todo56.dev/assets/images/logo.png" width="24">
        <small class="d-block mb-3 text-muted">&copy; 2021</small>

        <p class="mb-0">Made by Todo56.</p>
        <p class="mb-0"><a href="https://twitter.com/Todo56_" target="_blank">Twitter</a> - <a
                href="https://www.youtube.com/channel/UCar2WxPDlTiOA97gZOty9QA" target="_blank">Youtube</a> - <a
                href="https://github.com/Todo56" target="_blank">Github</a> - <a href="https://twitch.tv/todo568"
                                                                                 target="_blank">Twitch</a></p>
    </div>
</footer>
</body>
<script crossorigin="anonymous"
        integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg=="
        src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script crossorigin="anonymous"
        integrity="sha512-hDWGyh+Iy4Mr9AHOzUP2+Y0iVPn/BwxxaoSleEjH/i1o4EVTF/sh0/A1Syii8PWOae+uPr+T/KHwynoebSuAhw=="
        src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js"></script>
<script crossorigin="anonymous"
        integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV"
        src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script crossorigin="anonymous"
        integrity="sha384-LtrjvnR4Twt/qOuYxE721u19sVFLVSA4hf/rRt6PrZTmiPltdZcI7q7PXQBYTKyf"
        src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
<script src="./bower_components/crypto-js/crypto-js.js" type="text/javascript"></script>
<link href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-dark@3/dark.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@9/dist/sweetalert2.min.js"></script>
<script>
    function readFileToEncrypt() {
        return new Promise(resolve => {
            let element = document.getElementById("toencryptfile");
            let file = element.files[0];
            const reader = new FileReader();
            let data = [file];
            reader.addEventListener('load', (event) => {
                data.push(event.target.result);
                return resolve(data);
            });
            reader.readAsBinaryString(file);
        })
    }

    async function save(data, filename, type) {
        let blob = new Blob([data], {type: type});
        if(window.navigator.msSaveOrOpenBlob) {
            window.navigator.msSaveBlob(blob, filename);
        }
        else{
            let elem = window.document.createElement('a');
            elem.href = window.URL.createObjectURL(blob);
            elem.download = filename;
            document.body.appendChild(elem);
            elem.click();
            document.body.removeChild(elem);
        }
    }

    async function encryptData() {
        let text = document.getElementById("text").value;
        let file = null;
        if (text === "" && document.getElementById("toencryptfile").files.length === 0){
            return Swal.fire("Error", "Please input text to encrypt or upload a file.", "error");
        } else if(text === ""){
            file = await readFileToEncrypt();
            text = file[1];
        }
        text = encodeURI(text)
        let algoHTML = document.getElementById("encryption-algo");
        let algo = algoHTML.options[algoHTML.selectedIndex].value;
        let passwordForEncryption = document.getElementById("password").value;
        if (passwordForEncryption === "") {
            return Swal.fire("Error", "Please input a valid password.", "error");
        }
        let encryption;
        switch (algo) {
            case "aes":
                encryption = CryptoJS.AES.encrypt(text, passwordForEncryption).toString();
                break;
            case "des":
                encryption = CryptoJS.DES.encrypt(text, passwordForEncryption).toString();
                break;
            case "tripledes":
                encryption = CryptoJS.TripleDES.encrypt(text, passwordForEncryption).toString();
                break;
            case "rabbit":
                encryption = CryptoJS.Rabbit.encrypt(text, passwordForEncryption).toString();
                break;
            case "rc4":
                encryption = CryptoJS.RC4.encrypt(text, passwordForEncryption).toString();
                break;
            case "rc4drop":
                encryption = CryptoJS.RC4Drop.encrypt(text, passwordForEncryption).toString();
                break;
        }
        if(file){
            await save(encryption, file[0].name, file[0].type);
        } else {
            document.getElementById("data").value = encryption
        }
    }
    function readFileToDecrypt() {
        return new Promise(resolve => {
            let element = document.getElementById("todencryptfile");
            let file = element.files[0];
            const reader = new FileReader();
            let data = [file];
            reader.addEventListener('load', (event) => {
                data.push(event.target.result);
                return resolve(data);
            });
            reader.readAsBinaryString(file);
        })
    }
    async function decryptData() {

        let text = encodeURI(document.getElementById("dtext").value);
        let file = null;
        if (text === "" && document.getElementById("todencryptfile").files.length === 0){
            return Swal.fire("Error", "Please input text to encrypt or upload a file.", "error");
        } else if(text === ""){
            file = await readFileToDecrypt();
            text = file[1];
        }
        let algo = document.getElementById("dencryption-algo").value;
        let passwordForDecryption = document.getElementById("dpassword").value;
        if (passwordForDecryption === "") {
            return Swal.fire("Error", "Please input a valid password.", "error");
        }
        let decryption;
        switch (algo) {
            case "aes":
                decryption = CryptoJS.AES.decrypt(text, passwordForDecryption);
                break;
            case "des":
                decryption = CryptoJS.DES.decrypt(text, passwordForDecryption);
                break;
            case "tripledes":
                decryption = CryptoJS.TripleDES.decrypt(text, passwordForDecryption);
                break;
            case "rabbit":
                decryption = CryptoJS.Rabbit.decrypt(text, passwordForDecryption);
                break;
            case "rc4":
                decryption = CryptoJS.RC4.decrypt(text, passwordForDecryption);
                break;
            case "rc4drop":
                decryption = CryptoJS.RC4Drop.decrypt(text, passwordForDecryption);
                break;
        }
        decryption = decodeURI(decryption.toString(CryptoJS.enc.Latin1)).replaceAll("%2C", ",");
        if(file){
            await save(decryption, file[0].name, file[0].type);
        } else {
            document.getElementById("data").value = decryption
        }
    }

    new ClipboardJS('#copy');
</script>
</html>